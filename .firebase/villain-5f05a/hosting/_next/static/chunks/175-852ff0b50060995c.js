"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[175],{1175:(e,t,a)=>{a.d(t,{Xe:()=>o,eI:()=>i,k7:()=>d});var l=a(5155),r=a(2115),s=a(858),n=a(1559);function c(e){let{isOpen:t,onClose:a,title:r,children:s}=e;return t?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-neutral-300",children:r}),(0,l.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-neutral-500 dark:hover:text-neutral-300",children:"✕"})]}),s]})}):null}function o(e){let{isOpen:t,onClose:a,onSubmit:s,initialValue:n="",error:o}=e,[d,i]=(0,r.useState)(n),[u,x]=(0,r.useState)(o);(0,r.useEffect)(()=>{x(o)},[o]);let m=()=>d&&""!==d.trim()?d.length>20?(x("이름은 최대 20자까지 입력 가능합니다."),!1):(x(void 0),!0):(x("이름을 입력해주세요."),!1);return(0,l.jsx)(c,{isOpen:t,onClose:a,title:"이름 변경",children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),m()&&s(d)},className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-neutral-400 mb-1",children:"새로운 이름"}),(0,l.jsx)("input",{id:"displayName",type:"text",value:d,onChange:e=>{i(e.target.value),u&&x(void 0)},className:"block w-full px-3 py-2 border ".concat(u?"border-red-500 dark:border-red-700":"border-gray-300 dark:border-neutral-700"," rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-800 dark:text-neutral-300"),placeholder:"새로운 이름을 입력하세요",maxLength:20,autoFocus:!0}),u&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:u}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-neutral-500",children:[d.length,"/20자"]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-100 dark:bg-neutral-800 text-gray-700 dark:text-neutral-300 rounded-md hover:bg-gray-200 dark:hover:bg-neutral-700 transition-colors",children:"취소"}),(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 text-white rounded-md transition-colors ".concat(d.trim()?"bg-blue-500 hover:bg-blue-600":"bg-blue-400 cursor-not-allowed"),disabled:!d.trim(),children:"저장"})]})]})})}function d(e){let{isOpen:t,onClose:a,onSelect:n,currentImage:o}=e,[d,i]=(0,r.useState)([]),[u,x]=(0,r.useState)(!0),[m,h]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=async()=>{let e=(0,s.c7)(),t=[],a=0;try{for(let l of(console.log("프로필 이미지 로드 시작"),console.log("현재 Storage 버킷:",e.app.options.storageBucket),console.log("개발 환경 여부:",!1),["profile","avatar","user","person","woman","man","default","icon","pic"])){for(let r=1;r<=5;r++)try{let n="profile_images/".concat(l).concat(r,".webp");console.log("이미지 로드 시도: ".concat(n));let c=(0,s.KR)(e,n);console.log("이미지 참조 URL:",c.toString());let o=await (0,s.qk)(c);if(t.push(o),a++,console.log("이미지 로드 성공: ".concat(l).concat(r,".webp - URL: ").concat(o)),a>=15)break}catch(e){console.error("이미지 로드 실패: ".concat(l).concat(r,".webp - 오류:"),e.code,e.message)}if(a>=15)break}0===t.length&&(t.push("https://via.placeholder.com/150?text=User1"),t.push("https://via.placeholder.com/150?text=User2"),t.push("https://via.placeholder.com/150?text=User3"),console.log("외부 기본 이미지를 사용합니다.")),console.log("총 ".concat(t.length,"개의 이미지를 로드했습니다.")),i(t),h(null)}catch(e){console.error("이미지 로딩 실패:",e),h("프로필 이미지를 불러오는데 실패했습니다."),i(["https://via.placeholder.com/150?text=User1","https://via.placeholder.com/150?text=User2","https://via.placeholder.com/150?text=User3"])}finally{x(!1)}};t&&e()},[t]),(0,l.jsx)(c,{isOpen:t,onClose:a,title:"프로필 이미지 선택",children:u?(0,l.jsx)("div",{className:"text-center py-4 text-gray-700 dark:text-neutral-300",children:"로딩중..."}):m?(0,l.jsx)("div",{className:"text-center py-4 text-red-500 dark:text-red-400",children:m}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-3 gap-3",children:d.map((e,t)=>(0,l.jsx)("button",{onClick:()=>n(e),className:"relative rounded-lg overflow-hidden aspect-square ".concat(o===e?"ring-2 ring-blue-500":""),children:(0,l.jsx)("img",{src:e,alt:"프로필 이미지 ".concat(t+1),className:"w-full h-full object-cover"})},t))}),(0,l.jsx)("div",{className:"flex justify-end space-x-2",children:(0,l.jsx)("button",{onClick:a,className:"px-4 py-2 bg-gray-100 dark:bg-neutral-800 text-gray-700 dark:text-neutral-300 rounded-md hover:bg-gray-200 dark:hover:bg-neutral-700 transition-colors",children:"취소"})})]})})}let i=e=>{var t,a,s;let{isOpen:c,onClose:o,onSubmit:d,commentAuthor:i}=e,[u,x]=(0,r.useState)(""),{user:m}=(0,n.A)(),h=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&o()};return c?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[c,o]);let g=async e=>{e.preventDefault(),""!==u.trim()&&(await d(u),x(""),o())};return c?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,l.jsxs)("div",{ref:h,className:"relative bg-white dark:bg-neutral-900 w-full max-w-lg p-5 rounded-lg shadow-lg",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-neutral-200 mb-3",children:"답글 작성"}),(0,l.jsxs)("div",{className:"flex space-x-3 mb-4 bg-gray-100 dark:bg-neutral-800 p-3 rounded-lg",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0",children:(0,l.jsx)("div",{className:"w-full h-full bg-gray-300 dark:bg-neutral-700 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:(null==i||null==(t=i.charAt(0))?void 0:t.toUpperCase())||"?"})})}),(0,l.jsx)("div",{children:(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-neutral-300",children:i||"익명"})})]}),(0,l.jsx)("form",{onSubmit:g,children:(0,l.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0",children:m&&m.photoURL?(0,l.jsx)("img",{src:m.photoURL,alt:m.displayName||"",className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full bg-gray-300 dark:bg-neutral-700 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:(null==m||null==(s=m.displayName)||null==(a=s.charAt(0))?void 0:a.toUpperCase())||"?"})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("textarea",{value:u,onChange:e=>x(e.target.value),placeholder:"답글을 입력하세요...",maxLength:300,className:"w-full p-3 border border-gray-300 dark:border-neutral-700 rounded-lg text-gray-700 dark:text-neutral-300 dark:bg-neutral-800 focus:outline-none focus:ring-1 focus:ring-blue-500",rows:3,autoFocus:!0}),(0,l.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,l.jsxs)("span",{className:"text-xs text-gray-500 dark:text-neutral-500",children:[u.length,"/",300]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm text-gray-600 dark:text-neutral-400 hover:text-gray-800 dark:hover:text-neutral-200",children:"취소"}),(0,l.jsx)("button",{type:"submit",disabled:""===u.trim(),className:"px-4 py-2 text-sm rounded-lg text-white ".concat(""===u.trim()?"bg-gray-400 dark:bg-neutral-700 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"),children:"등록"})]})]})]})]})})]})}):null}}}]);