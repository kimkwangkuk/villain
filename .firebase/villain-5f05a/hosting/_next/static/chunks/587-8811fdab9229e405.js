"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[587],{5812:(e,t,r)=>{r.d(t,{bW:()=>a,x0:()=>o});var s=r(9670),n=r(5317);let a=async()=>{try{console.log("카테고리 가져오기 시작");let e=(0,n.P)((0,n.rJ)(s.db,"categories"),(0,n.My)("order")),t=(await (0,n.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));return console.log("카테고리 ".concat(t.length,"개 가져오기 성공:"),t.map(e=>e.name)),t}catch(e){return console.error("카테고리 가져오기 실패:",e),[]}},o=async()=>{let e=[];for(let t of[{customId:"category1",order:1,name:"스타트업",description:"소규모 신생 기업에서 발생하는 문제 상황. 예시: 업무 과부하, 잦은 방향 전환, 불안정한 고용 환경"},{customId:"category2",order:2,name:"중소기업",description:"중소기업 환경에서 발생하는 문제 상황. 예시: 다재다능 강요, 비효율적인 시스템, 임금 체불"},{order:3,name:"대기업",description:"대기업 환경에서 발생하는 문제 상황. 예시: 과도한 보고 문화, 끝없는 회의, 상명하복식 의사결정, 내부 정치 싸움"},{order:4,name:"서비스업",description:"고객 응대가 많은 업종(카페, 식당, 백화점, 콜센터 등). 예시: 진상 고객, 반말 손님, 감정 노동 강요하는 상사"},{order:5,name:"공공기관",description:"공무원, 공기업 직원들이 겪는 문제 상황. 예시: 과도한 민원, 공공시설 훼손, 무리한 요구"},{order:6,name:"의료직",description:"병원, 요양원, 약국 등에서 근무하는 의료진이 겪는 문제 상황. 예시: 무리한 요구 환자, 보호자 갑질, 비협조적인 환자"},{order:7,name:"교육직",description:"초중고교, 대학교, 학원 등에서 발생하는 문제 상황. 예시: 학부모 민원, 무례한 학생, 책임 회피하는 동료 교사"},{order:8,name:"공장/생산직",description:"제조업, 생산라인, 물류센터 등에서 발생하는 문제 상황. 예시: 안전불감증, 업무 미루기, 비협조적인 조장"},{order:9,name:"건설업",description:"건설 현장, 토목 공사, 인테리어 업종에서 발생하는 문제 상황. 예시: 부실 시공, 작업 안전 무시, 임금 체불"},{order:10,name:"유통/물류",description:"마트, 편의점, 배달업 등에서 발생하는 문제 상황. 예시: 상품 훼손, 계산대 진상, 배달 클레임"},{order:11,name:"프리랜서",description:"작가, 디자이너, 영상 제작자, 프리랜서 등이 겪는 문제 상황. 예시: 돈 떼먹는 클라이언트, 수정 무한 요청, 아이디어 도용"},{order:12,name:"경찰",description:"경찰이 업무 중 겪는 문제 상황. 예시: 시민과의 마찰, 불필요한 신고, 내부 갈등"},{order:13,name:"소방",description:"소방관이 업무 중 겪는 문제 상황. 예시: 허위 신고, 장비 부족, 위험한 출동 상황"},{order:14,name:"군대",description:"군대에서 발생하는 문제 상황. 예시: 가혹 행위, 부조리, 무책임한 간부"}]){let r=await (0,n.gS)((0,n.rJ)(s.db,"categories"),{...t,createdAt:(0,n.O5)()});e.push({id:r.id,...t})}return console.log("카테고리 생성 완료:",e.length),e}},7624:(e,t,r)=>{r.d(t,{A:()=>y});var s=r(5155),n=r(2115),a=r(6874),o=r.n(a),l=r(5695),i=r(8402),c=r(2723),d=r(7242),u=r(1559),m=r(832),x=r.n(m);r(9810);var h=r(9758),p=r.n(h),f=r(1694),j=r(8038),v=r(285),g=r(6695),N=r(1394),w=r(4838);x().locale("ko"),x().extend(p());let y=function(e){var t,r,a,m;let h,{post:p,categories:y,onShare:b}=e,[k,E]=(0,n.useState)(""),[C,S]=(0,n.useState)(p.likes||0),[L,D]=(0,n.useState)(!1),[I,P]=(0,n.useState)(0),{isLoggedIn:z,user:A}=(0,u.A)(),[_,B]=(0,n.useState)(!1);(0,l.useRouter)();let[R,$]=(0,n.useState)(!1),[O,F]=(0,n.useState)(null),G=(0,n.useRef)(null),[J,U]=(0,n.useState)(p.reactionCount||0),[W,q]=(0,n.useState)(null),[K,M]=(0,n.useState)(!1),Q=(0,n.useRef)(null),[Z,H]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=e=>{e.target.closest("button")||G.current&&!G.current.contains(e.target)&&$(!1)};return R&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[R]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&$(!1)};return R&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[R]),(0,n.useEffect)(()=>{let e=e=>{Q.current&&!Q.current.contains(e.target)&&M(!1)};return K&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[K]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&M(!1)};return K&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[K]),(0,n.useEffect)(()=>{if(y&&y.length>0){let e=y.find(e=>e.id===p.categoryId);e&&E(e.name)}P(p.commentCount||0),U(p.reactionCount||0),A&&p.likedBy&&D(p.likedBy.includes(A.uid))},[y,p.categoryId,p.likedBy,p.id,A,p.commentCount,p.reactionCount]),(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,c.l)(p.id);A&&e[A.uid]&&q(e[A.uid]);let t={};Object.values(e).forEach(e=>{e&&e.emoji&&(t[e.emoji]||(t[e.emoji]=0),t[e.emoji]++)});let r=Object.keys(t).sort((e,r)=>t[r]-t[e]).slice(0,3);H(r)}catch(e){console.error("반응 데이터 로드 실패:",e)}})()},[p.id,A]);let T=async e=>{if(e.preventDefault(),e.stopPropagation(),!z||!A)return void alert("로그인이 필요합니다.");if(R)return void $(!1);if(W){try{q(null);let e=await (0,c.t)(p.id,A.uid,null);U(e.reactionCount)}catch(e){console.error("반응 취소 실패:",e),alert("반응 취소에 실패했습니다.")}return}$(!0)},V=async e=>{try{if((null==W?void 0:W.id)===e.id){q(null),$(!1);let e=await (0,c.t)(p.id,A.uid,null);U(e.reactionCount);return}q(e),$(!1);let t=await (0,c.t)(p.id,A.uid,e);if(U(t.reactionCount),!t)throw q(W),Error("반응 업데이트 실패")}catch(e){console.error("반응 처리 실패:",e),alert("반응 처리에 실패했습니다.")}},X=async e=>{if(e.preventDefault(),e.stopPropagation(),M(!1),!z||!A)return void alert("로그인이 필요합니다.");let t=prompt("신고 사유를 입력해주세요:");if(t)try{await (0,d.wD)("post",p.id,A.uid,t),alert("신고가 접수되었습니다.")}catch(e){console.error("신고 처리 실패:",e),alert("신고 처리에 실패했습니다.")}},Y=async e=>{if(e.preventDefault(),e.stopPropagation(),M(!1),window.confirm("이 게시물을 삭제하시겠습니까? 삭제 후에는 복구할 수 없습니다."))try{await (0,i.ys)(p.id),alert("게시물이 삭제되었습니다."),window.location.reload()}catch(e){console.error("게시물 삭제 실패:",e),alert("게시물 삭제에 실패했습니다.")}finally{}};return(0,s.jsx)(o(),{href:"/postdetail/".concat(p.id),className:"block transition-colors duration-200",children:(0,s.jsx)(g.Zp,{className:"h-full hover:bg-muted/5 py-3",children:(0,s.jsxs)(g.Wu,{className:"flex flex-col h-[360px] px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)(N.eu,{className:"w-8 h-8",children:[(0,s.jsx)(N.BK,{src:p.authorPhotoURL||"https://via.placeholder.com/40x40",alt:"".concat(p.authorName,"의 프로필")}),(0,s.jsx)(N.q5,{children:(null==(r=p.authorName)||null==(t=r.charAt(0))?void 0:t.toUpperCase())||"?"})]}),(0,s.jsxs)("div",{className:"ml-2",children:[(0,s.jsx)("div",{className:"text-[13px] font-semibold",children:p.authorName}),(0,s.jsxs)("div",{className:"text-[12px] text-muted-foreground",children:[(0,s.jsx)("span",{children:k}),(0,s.jsx)("span",{className:"mx-1",children:"\xb7"}),(0,s.jsx)("span",{children:(null==(a=p.createdAt)?void 0:a.toDate)&&(h=null==(m=p.createdAt)?void 0:m.toDate(),x()(h).fromNow())})]})]})]}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)(w.rI,{children:[(0,s.jsx)(w.ty,{asChild:!0,children:(0,s.jsx)(v.$,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full",children:(0,s.jsx)("span",{className:"text-muted-foreground",children:"⋮"})})}),(0,s.jsxs)(w.SQ,{align:"end",children:[(0,s.jsx)(w._2,{onClick:X,children:"신고하기"}),A&&p.authorId===A.uid&&(0,s.jsx)(w._2,{onClick:Y,className:"text-destructive",children:"삭제하기"})]})]})})]}),(0,s.jsx)("h2",{className:"text-[17px] font-bold mb-2 line-clamp-2",children:p.title}),(0,s.jsx)("div",{className:"flex-grow overflow-hidden",children:(0,s.jsx)("p",{className:"text-[15px] text-muted-foreground line-clamp-7 whitespace-pre-wrap break-words",children:p.content})}),(0,s.jsxs)("div",{className:"mt-auto pt-2 flex items-center justify-between text-[14px] text-muted-foreground pb-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[Z.length>0&&(0,s.jsx)("div",{className:"flex -space-x-1 mr-2",children:Z.map((e,t)=>(0,s.jsx)("div",{className:"w-5 h-5 flex items-center justify-center bg-background rounded-full text-sm border border-border shadow-sm",style:{zIndex:3-t,marginLeft:t>0?"-8px":"0"},children:e},t))}),(0,s.jsxs)("span",{className:"text-xs",children:[J||0,"명의 반응"]})]}),(0,s.jsxs)("span",{className:"text-xs",children:["댓글 ",I||0]})]}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 -mx-4 px-4",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-[33%]",children:[(0,s.jsxs)(v.$,{onClick:T,variant:"ghost",size:"sm",className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground",children:[W?(0,s.jsx)("span",{className:"text-base",children:W.emoji}):(0,s.jsx)(f.px,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm ".concat(W?"text-[#FF2600]":""),children:W?W.label:"반응"})]}),R&&(0,s.jsx)("div",{ref:G,className:"absolute bottom-full left-0 mb-2 bg-popover rounded-md shadow-md p-2 z-50 flex space-x-2 border border-border",children:j.Br.map(e=>(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),V(e)},className:"text-xl p-2 hover:bg-accent rounded-full transition-transform ".concat((null==W?void 0:W.id)===e.id?"scale-125 bg-accent/50":""),title:e.label,children:e.emoji},e.id))})]}),(0,s.jsx)("div",{className:"flex-1 max-w-[33%] flex justify-center",children:(0,s.jsxs)(v.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground",children:[(0,s.jsx)(f.b1,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"댓글"})]})}),(0,s.jsx)("div",{className:"flex-1 max-w-[33%] flex justify-end",children:(0,s.jsxs)(v.$,{onClick:e=>{e.preventDefault(),e.stopPropagation(),b&&b(e,p.id)},variant:"ghost",size:"sm",className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground",children:[(0,s.jsx)(f.li,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"공유"})]})})]})})]})})})}}}]);