(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{285:(e,r,o)=>{"use strict";o.d(r,{$:()=>i});var t=o(5155);o(2115);var a=o(9708),s=o(2085),l=o(9434);let n=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-background dark:border-input dark:hover:bg-accent/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function i(e){let{className:r,variant:o,size:s,asChild:i=!1,...d}=e,c=i?a.DX:"button";return(0,t.jsx)(c,{"data-slot":"button",className:(0,l.cn)(n({variant:o,size:s,className:r})),...d})}},480:(e,r,o)=>{"use strict";o.r(r),o.d(r,{default:()=>f});var t=o(5155),a=o(2115),s=o(6874),l=o.n(s),n=o(5695),i=o(1559);o(9670);var d=o(9434),c=o(285),u=o(6695);function g(e){let{className:r,type:o,...a}=e;return(0,t.jsx)("input",{type:o,"data-slot":"input",className:(0,d.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-background border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...a})}var m=o(3655),h=a.forwardRef((e,r)=>(0,t.jsx)(m.sG.label,{...e,ref:r,onMouseDown:r=>{var o;r.target.closest("button, input, select, textarea")||(null==(o=e.onMouseDown)||o.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));function p(e){let{className:r,...o}=e;return(0,t.jsx)(h,{"data-slot":"label",className:(0,d.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...o})}function x(e){let{className:r,...o}=e,s=(0,n.useRouter)(),m=(0,n.useSearchParams)(),{login:h,googleLogin:x}=(0,i.A)(),[f,b]=(0,a.useState)({email:"",password:""}),[v,w]=(0,a.useState)(""),[y,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),I=m.get("redirect")||"/home",A=e=>{b({...f,[e.target.name]:e.target.value})},S=async e=>{e.preventDefault(),w(""),j(!0);try{await h(f.email.trim(),f.password),console.log("로그인 성공"),console.log("이동할 경로:",I),s.push(I)}catch(e){console.error("로그인 실패:",e),w(e.message||"로그인에 실패했습니다.")}finally{j(!1)}},L=async()=>{try{k(!0),w(""),console.log("구글 로그인 시도 - 로그인 페이지"),console.log("현재 URL:",window.location.href),console.log("잠시 후 로그인 팝업이 열립니다. 팝업 차단을 허용해 주세요.");let e=setTimeout(()=>{console.error("구글 로그인 시간 초과 (10초)"),w("로그인 요청이 시간 초과되었습니다. 네트워크 연결을 확인하고 다시 시도해주세요."),k(!1)},1e4),r=await x();if(clearTimeout(e),r)console.log("구글 로그인 성공 - 로그인 페이지"),console.log("로그인 사용자 정보:",{uid:r.uid,email:r.email,name:r.displayName}),setTimeout(()=>{k(!1),s.push(I)},1e3);else throw k(!1),Error("로그인은 성공했지만 사용자 정보를 받지 못했습니다.")}catch(e){k(!1),console.error("Google 로그인 실패 - 로그인 페이지:",e),e.code&&console.error("오류 코드:",e.code),e.message&&console.error("오류 메시지:",e.message),"auth/unauthorized-domain"===e.code?(w("현재 도메인이 Firebase에 등록되지 않았습니다. Firebase 콘솔에서 도메인을 추가해주세요."),console.error("Firebase 콘솔에서 승인된 도메인 목록에 현재 도메인(localhost)을 추가해야 합니다."),console.error("https://console.firebase.google.com/project/_/authentication/settings 에서 승인된 도메인을 확인해주세요."),console.error("에뮬레이터를 사용 중인지 확인하세요. 에뮬레이터 사용 시 도메인 제한이 우회됩니다.")):"auth/popup-closed-by-user"===e.code?w("로그인 팝업이 닫혔습니다. 팝업 창을 닫지 말고 로그인을 완료해 주세요."):"auth/popup-blocked"===e.code?w("브라우저에서 팝업이 차단되었습니다. 팝업 차단을 해제하고 다시 시도해 주세요."):"auth/network-request-failed"===e.code?(w("네트워크 연결에 문제가 있습니다. 인터넷 연결을 확인하고 다시 시도해 주세요."),console.error("로컬호스트와 Firebase 서버 간의 연결에 문제가 있습니다."),console.error("CORS 또는 네트워크 문제일 수 있습니다.")):"auth/internal-error"===e.code?(w("Firebase 내부 오류가 발생했습니다. 잠시 후 다시 시도해 주세요."),console.error("Firebase 내부 오류 - 에뮬레이터 설정을 확인하세요.")):"auth/cancelled-popup-request"===e.code?w("이전 팝업 요청이 취소되었습니다. 다시 시도해 주세요."):w("Google 로그인에 실패했습니다: ".concat(e.code||"알 수 없는 오류"))}};return(0,t.jsxs)("div",{className:(0,d.cn)("flex flex-col gap-6",r),...o,children:[(0,t.jsx)(u.Zp,{className:"overflow-hidden",children:(0,t.jsxs)(u.Wu,{className:"grid p-0 md:grid-cols-2",children:[(0,t.jsx)("form",{onSubmit:S,className:"p-6 md:p-8",children:(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"환영합니다"}),(0,t.jsx)("p",{className:"text-balance text-muted-foreground",children:"Villain 계정으로 로그인하세요"})]}),v&&(0,t.jsx)("div",{className:"p-3 text-sm bg-red-50 border border-red-200 text-red-600 rounded-md dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:v}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(p,{htmlFor:"email",children:"이메일"}),(0,t.jsx)(g,{id:"email",name:"email",type:"email",placeholder:"example@email.com",required:!0,value:f.email,onChange:A})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(p,{htmlFor:"password",children:"비밀번호"}),(0,t.jsx)(l(),{href:"/forgot-password",className:"ml-auto text-sm underline-offset-4 hover:underline",children:"비밀번호를 잊으셨나요?"})]}),(0,t.jsx)(g,{id:"password",name:"password",type:"password",required:!0,value:f.password,onChange:A})]}),(0,t.jsx)(c.$,{type:"submit",className:"w-full",disabled:y,children:y?"로그인 중...":"로그인"}),(0,t.jsx)("div",{className:"relative text-center text-sm after:absolute after:inset-0 after:top-1/2 after:z-0 after:flex after:items-center after:border-t after:border-border",children:(0,t.jsx)("span",{className:"relative z-10 bg-background px-2 text-muted-foreground",children:"또는"})}),(0,t.jsxs)(c.$,{variant:"outline",className:"flex w-full items-center justify-center gap-2 bg-background dark:bg-background",onClick:L,disabled:N,type:"button",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-5 w-5",children:(0,t.jsx)("path",{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z",fill:"currentColor"})}),N?"로그인 중...":"Google로 로그인"]}),(0,t.jsxs)("div",{className:"text-center text-sm",children:["계정이 없으신가요?"," ",(0,t.jsx)(l(),{href:"/signup",className:"underline underline-offset-4",children:"회원가입"})]})]})}),(0,t.jsx)("div",{className:"relative hidden bg-muted md:block",children:(0,t.jsx)("img",{src:"/placeholder.svg",alt:"로그인 이미지",className:"absolute inset-0 h-full w-full object-cover dark:brightness-[0.2] dark:grayscale"})})]})}),(0,t.jsxs)("div",{className:"text-balance text-center text-xs text-muted-foreground [&_a]:underline [&_a]:underline-offset-4 hover:[&_a]:text-primary",children:["계속 진행하면 ",(0,t.jsx)("a",{href:"#",children:"서비스 이용약관"}),"과"," ",(0,t.jsx)("a",{href:"#",children:"개인정보 처리방침"}),"에 동의하게 됩니다."]})]})}function f(){let[e,r]=(0,a.useState)(!1),[o,s]=(0,a.useState)(null);return((0,a.useEffect)(()=>{r(!0),console.log("로그인 페이지 마운트됨")},[]),o)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background px-4 py-12",children:(0,t.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"오류가 발생했습니다"}),(0,t.jsx)("p",{children:o.message}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-100 dark:bg-red-800/30 rounded-md hover:bg-red-200 dark:hover:bg-red-800/50",children:"페이지 새로고침"})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background px-4 py-12",children:e?(0,t.jsx)(x,{className:"w-full max-w-3xl"}):(0,t.jsx)("div",{className:"animate-pulse flex space-x-4",children:(0,t.jsx)("div",{className:"w-full max-w-3xl h-[600px] bg-gray-200 dark:bg-gray-700 rounded-lg"})})})}h.displayName="Label"},1559:(e,r,o)=>{"use strict";o.d(r,{AuthProvider:()=>p,A:()=>h});var t=o(5155),a=o(2115),s=o(9670),l=o(6203);let n={login:async(e,r)=>{try{return await (0,l.x9)(s.j2,e,r)}catch(e){throw e}},logout:async()=>await (0,l.CI)(s.j2),onAuthStateChange:e=>(0,l.hg)(s.j2,e)};var i=o(5317),d=o(858);let c=()=>{let e=["행복한","즐거운","신나는","멋진","훌륭한","대단한","귀여운","친절한","똑똑한","현명한"],r=["고양이","강아지","토끼","여우","사자","호랑이","판다","코알라","기린","코끼리"],o=Math.floor(1e3*Math.random()),t=e[Math.floor(Math.random()*e.length)],a=r[Math.floor(Math.random()*r.length)];return"".concat(t).concat(a).concat(o)},u=async()=>{try{console.log("랜덤 프로필 이미지 가져오기 시도");let e=Math.floor(2*Math.random())+1,r=(0,d.KR)(s.IG,"profile_images/woman".concat(e,".webp")),o=await (0,d.qk)(r);return console.log("프로필 이미지 URL 가져오기 성공:",o),o}catch(e){return console.error("프로필 이미지 가져오기 실패:",e),"https://example.com/default-profile.jpg"}},g=async()=>{try{console.log("API: Google 로그인 시도 중...");let e=new l.HF;e.addScope("profile"),e.addScope("email");let r=(await (0,l.df)(s.j2,e)).user;console.log("API: Google 로그인 성공 -",r.email);let o=await u();o||(o="https://example.com/default-profile.jpg");let t=c();console.log("생성된 사용자 이름:",t),r&&(await (0,l.r7)(r,{displayName:t,photoURL:o}),console.log("사용자 프로필 업데이트 성공")),console.log("Firestore에 사용자 정보 저장 시도");let a=(0,i.H9)(s.db,"users",r.uid);return(await (0,i.x7)(a)).exists()?console.log("이미 등록된 사용자입니다"):(await (0,i.BN)(a,{userId:r.uid,email:r.email,username:t,photoURL:o,createdAt:(0,i.O5)(),bio:""}),console.log("Firestore 사용자 정보 저장 성공")),r}catch(e){throw console.error("API: Google 로그인 실패 -",e),e.code&&console.error("API: 오류 코드 -",e.code),e.message&&console.error("API: 오류 메시지 -",e.message),e.message&&e.message.includes("redirect_uri_mismatch")&&(console.error("API: === 리디렉션 URI 불일치 오류 ==="),console.error("API: 현재 URL:",window.location.href),console.error("API: 현재 호스트:",window.location.host),console.error("API: 현재 오리진:",window.location.origin),console.error("API: 이 오류는 Firebase 콘솔에 등록된 도메인과 현재 사용 중인 도메인이 일치하지 않을 때 발생합니다."),console.error("API: Firebase 콘솔(https://console.firebase.google.com/project/villain-5f05a/authentication/settings)에서"),console.error('API: "승인된 도메인" 목록에 현재 도메인을 추가해주세요.'),console.error("API: ===================================")),"auth/popup-blocked"===e.code?console.error("팝업이 차단되었습니다. 브라우저 설정에서 팝업 허용을 확인해주세요."):"auth/popup-closed-by-user"===e.code?console.error("사용자가 팝업을 닫았습니다."):"auth/cancelled-popup-request"===e.code?console.error("이전 팝업 요청이 있어 새 요청이 취소되었습니다."):"auth/unauthorized-domain"===e.code&&(console.error("현재 도메인이 Firebase 콘솔에 등록되지 않았습니다."),console.error('Firebase 콘솔에서 "승인된 도메인" 목록에 현재 도메인을 추가해주세요.'),console.error("승인이 필요한 도메인:",window.location.host)),e}},m=(0,a.createContext)(null),h=()=>{let e=(0,a.useContext)(m);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function p(e){let{children:r}=e,[o,s]=(0,a.useState)(!1),[l,i]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=n.onAuthStateChange(e=>{e?(i({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL}),s(!0),localStorage.setItem("isLoggedIn","true")):(i(null),s(!1),localStorage.removeItem("isLoggedIn")),c(!1)});return()=>e()},[]);let u=async(e,r)=>{try{let o=await n.login(e,r),t={uid:o.user.uid,email:o.user.email,displayName:o.user.displayName,photoURL:o.user.photoURL};return i(t),s(!0),localStorage.setItem("isLoggedIn","true"),t}catch(e){throw console.error("로그인 실패:",e),e}},h=async()=>{try{await n.logout(),i(null),s(!1),localStorage.removeItem("isLoggedIn")}catch(e){throw console.error("로그아웃 실패:",e),e}},p=async()=>{try{console.log("AuthContext: Google 로그인 시도");let e=await g();console.log("AuthContext: Google 로그인 성공, UID:",e.uid);let r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL};return i(r),s(!0),localStorage.setItem("isLoggedIn","true"),r}catch(e){throw console.error("AuthContext: Google 로그인 실패:",e),e instanceof Error&&(console.error("AuthContext: 오류 메시지:",e.message),console.error("AuthContext: 오류 스택:",e.stack)),e}};return d?(0,t.jsx)("div",{children:"Loading..."}):(0,t.jsx)(m.Provider,{value:{isLoggedIn:o,setIsLoggedIn:s,user:l,setUser:i,login:u,logout:h,googleLogin:p,loading:d},children:r})}},2250:(e,r,o)=>{Promise.resolve().then(o.bind(o,480))},6695:(e,r,o)=>{"use strict";o.d(r,{Wu:()=>n,Zp:()=>s,aR:()=>l,wL:()=>i});var t=o(5155);o(2115);var a=o(9434);function s(e){let{className:r,...o}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col rounded-xl border py-6 shadow-sm",r),...o})}function l(e){let{className:r,...o}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...o})}function n(e){let{className:r,...o}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",r),...o})}function i(e){let{className:r,...o}=e;return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",r),...o})}},9434:(e,r,o)=>{"use strict";o.d(r,{cn:()=>s});var t=o(2596),a=o(9688);function s(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(0,a.QP)((0,t.$)(r))}},9670:(e,r,o)=>{"use strict";o.d(r,{IG:()=>u,db:()=>d,j2:()=>c});var t=o(3915),a=o(6864),s=o(6203),l=o(5317),n=o(858);console.log("Firebase 초기화 - 브라우저 환경"),console.log("현재 환경:","production"),console.log("현재 URL:",window.location.href),console.log("현재 호스트:",window.location.host),console.log("현재 오리진:",window.location.origin);let i=(0,t.Wp)({apiKey:"AIzaSyAdmo8SKrrkDocCXGIE_eOo4QxWMxA0is8",authDomain:"villain.today",projectId:"villain-5f05a",storageBucket:"villain-5f05a.firebasestorage.app",messagingSenderId:"579679958637",appId:"1:579679958637:web:38705cebd28d47fc803164",measurementId:"G-0MLWMN815Q"});try{(0,a.P5)(i)}catch(e){console.error("Analytics initialization failed:",e)}let d=(0,l.aU)(i),c=(0,s.xI)(i),u=(0,n.c7)(i);new s.HF}},e=>{var r=r=>e(e.s=r);e.O(0,[992,146,855,874,389,441,684,358],()=>r(2250)),_N_E=e.O()}]);