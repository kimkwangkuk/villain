(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{5812:(e,t,r)=>{"use strict";r.d(t,{bW:()=>o,x0:()=>l});var a=r(9670),n=r(5317);let o=async()=>{try{console.log("카테고리 가져오기 시작");let e=(0,n.P)((0,n.rJ)(a.db,"categories"),(0,n.My)("order")),t=(await (0,n.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));return console.log("카테고리 ".concat(t.length,"개 가져오기 성공:"),t.map(e=>e.name)),t}catch(e){return console.error("카테고리 가져오기 실패:",e),[]}},l=async()=>{let e=[];for(let t of[{customId:"category1",order:1,name:"스타트업",description:"소규모 신생 기업에서 발생하는 문제 상황. 예시: 업무 과부하, 잦은 방향 전환, 불안정한 고용 환경"},{customId:"category2",order:2,name:"중소기업",description:"중소기업 환경에서 발생하는 문제 상황. 예시: 다재다능 강요, 비효율적인 시스템, 임금 체불"},{order:3,name:"대기업",description:"대기업 환경에서 발생하는 문제 상황. 예시: 과도한 보고 문화, 끝없는 회의, 상명하복식 의사결정, 내부 정치 싸움"},{order:4,name:"서비스업",description:"고객 응대가 많은 업종(카페, 식당, 백화점, 콜센터 등). 예시: 진상 고객, 반말 손님, 감정 노동 강요하는 상사"},{order:5,name:"공공기관",description:"공무원, 공기업 직원들이 겪는 문제 상황. 예시: 과도한 민원, 공공시설 훼손, 무리한 요구"},{order:6,name:"의료직",description:"병원, 요양원, 약국 등에서 근무하는 의료진이 겪는 문제 상황. 예시: 무리한 요구 환자, 보호자 갑질, 비협조적인 환자"},{order:7,name:"교육직",description:"초중고교, 대학교, 학원 등에서 발생하는 문제 상황. 예시: 학부모 민원, 무례한 학생, 책임 회피하는 동료 교사"},{order:8,name:"공장/생산직",description:"제조업, 생산라인, 물류센터 등에서 발생하는 문제 상황. 예시: 안전불감증, 업무 미루기, 비협조적인 조장"},{order:9,name:"건설업",description:"건설 현장, 토목 공사, 인테리어 업종에서 발생하는 문제 상황. 예시: 부실 시공, 작업 안전 무시, 임금 체불"},{order:10,name:"유통/물류",description:"마트, 편의점, 배달업 등에서 발생하는 문제 상황. 예시: 상품 훼손, 계산대 진상, 배달 클레임"},{order:11,name:"프리랜서",description:"작가, 디자이너, 영상 제작자, 프리랜서 등이 겪는 문제 상황. 예시: 돈 떼먹는 클라이언트, 수정 무한 요청, 아이디어 도용"},{order:12,name:"경찰",description:"경찰이 업무 중 겪는 문제 상황. 예시: 시민과의 마찰, 불필요한 신고, 내부 갈등"},{order:13,name:"소방",description:"소방관이 업무 중 겪는 문제 상황. 예시: 허위 신고, 장비 부족, 위험한 출동 상황"},{order:14,name:"군대",description:"군대에서 발생하는 문제 상황. 예시: 가혹 행위, 부조리, 무책임한 간부"}]){let r=await (0,n.gS)((0,n.rJ)(a.db,"categories"),{...t,createdAt:(0,n.O5)()});e.push({id:r.id,...t})}return console.log("카테고리 생성 완료:",e.length),e}},6544:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(5155),n=r(2115),o=r(5695),l=r(1694),d=r(9960),s=r(7650);let i=n.createContext(null),c=e=>{let{children:t,selectedValue:r,onChange:o,...l}=e,[d,s]=(0,n.useState)(!1),[c,x]=(0,n.useState)({top:0,left:0,width:0}),u=(0,n.useRef)(null),p=(0,n.useRef)(null),h=()=>{s(!1)};return(0,n.useEffect)(()=>{if(d&&u.current){let e=u.current.getBoundingClientRect();x({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})}},[d]),(0,n.useEffect)(()=>{let e=e=>{p.current&&e.target instanceof Node&&!p.current.contains(e.target)&&u.current&&!u.current.contains(e.target)&&h()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,a.jsx)(i.Provider,{value:{isOpen:d,toggleDropdown:()=>{s(!d)},closeDropdown:h,handleItemSelect:e=>{o&&o(e),h()},buttonRef:u,menuRef:p,position:c,selectedValue:r},...l,children:(0,a.jsx)("div",{className:"relative",children:t})})};c.Button=e=>{let{children:t,...r}=e,o=n.useContext(i);if(!o)throw Error("Button must be used within a Dropdown");let{toggleDropdown:d,buttonRef:s}=o;return(0,a.jsxs)("button",{type:"button",ref:s,onClick:d,className:"text-[15px] text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white px-[11px] py-[7px] pr-9 rounded-[8px] border border-gray-200 dark:border-neutral-700 hover:border-gray-300 dark:hover:border-neutral-600 font-medium min-w-[120px] bg-white dark:bg-neutral-800 relative text-left",...r,children:[t,(0,a.jsx)("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-500 dark:text-neutral-500",children:(0,a.jsx)(l.mu,{className:"w-4 h-4"})})]})},c.Menu=e=>{let{children:t,...r}=e,o=n.useContext(i);if(!o)throw Error("Menu must be used within a Dropdown");let{isOpen:l,menuRef:d,position:c}=o;return l?(0,s.createPortal)((0,a.jsx)("div",{ref:d,className:"fixed bg-white dark:bg-neutral-800 rounded-[8px] shadow-lg z-50 max-h-60 overflow-auto flex flex-col border border-gray-200 dark:border-neutral-700 mt-1",style:{top:"".concat(c.top+4,"px"),left:"".concat(c.left+c.width-Math.max(c.width,120),"px"),width:"".concat(Math.max(c.width,120),"px"),minWidth:"120px",maxWidth:"300px"},...r,children:t}),document.body):null},c.Item=e=>{let{children:t,value:r,...o}=e,l=n.useContext(i);if(!l)throw Error("Item must be used within a Dropdown");let{handleItemSelect:d,selectedValue:s}=l,c=r===s;return(0,a.jsx)("button",{className:"w-full text-left px-4 py-3 text-[15px] hover:bg-gray-100 dark:hover:bg-neutral-700 block font-medium border-0 border-b border-gray-100 dark:border-neutral-800 last:border-0 ".concat(c?"bg-gray-100 dark:bg-neutral-700 text-gray-900 dark:text-white":"text-gray-700 dark:text-neutral-300"),onClick:()=>d(r),...o,children:t})};var x=r(5812),u=r(8402),p=r(1559);function h(){let e=(0,o.useRouter)(),{user:t,loading:r}=(0,p.A)(),[s,i]=(0,n.useState)({title:"",content:"",category:""}),[h,m]=(0,n.useState)([]),[g,b]=(0,n.useState)(!0),[f,y]=(0,n.useState)(!1),[w,k]=(0,n.useState)({});(0,n.useEffect)(()=>{r||t||(alert("로그인이 필요합니다."),e.push("/login"))},[t,r,e]),(0,n.useEffect)(()=>{(async()=>{try{b(!0);let e=await (0,x.bW)();m(e||[])}catch(e){console.error("카테고리 로딩 실패:",e),k({...w,general:"카테고리를 불러오는데 실패했습니다."})}finally{b(!1)}})()},[]);let v=e=>{let{name:t,value:r}=e.target;i(e=>({...e,[t]:r})),w[t]&&k(e=>{let r={...e};return delete r[t],r})},j=()=>{let e={};return s.category||(e.category="카테고리를 선택해주세요."),s.title.trim()||(e.title="제목을 입력해주세요."),s.content.trim()||(e.content="내용을 입력해주세요."),k(e),0===Object.keys(e).length},N=async r=>{if(r.preventDefault(),!j())return void(w.category?alert(w.category):w.title?alert(w.title):w.content&&alert(w.content));if(!t){alert("로그인이 필요합니다."),e.push("/login");return}try{y(!0);let t=await (0,u.pD)({title:s.title,content:s.content,categoryId:s.category});console.log("게시글 생성 완료:",t),e.push("/")}catch(e){console.error("게시글 작성 실패:",e),alert(e.message||"게시글 작성에 실패했습니다.")}finally{y(!1)}};return r?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#E6E6E6] dark:bg-black",children:(0,a.jsx)("p",{className:"text-lg text-gray-700 dark:text-gray-300",children:"로딩 중..."})}):(0,a.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-start pt-4 pb-4 px-4 bg-[#E6E6E6] dark:bg-black md:justify-center md:py-10 md:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"w-full md:max-w-[590px] mx-4 bg-white dark:bg-[#0A0A0A] rounded-3xl shadow-[0_90px_70px_rgba(0,0,0,0.05)] dark:shadow-[0_90px_70px_rgba(0,0,0,0.2)] relative overflow-hidden before:absolute before:inset-0 before:-z-10 before:blur-4xl before:bg-gradient-to-b before:from-white/25 dark:before:from-black/25 before:to-transparent before:rounded-2xl",children:[(0,a.jsxs)("div",{className:"w-full p-[20px] border-b border-gray-100 dark:border-neutral-900 bg-gray-100 dark:bg-[#121212]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-100 dark:bg-neutral-800 flex items-center justify-center",children:(0,a.jsx)(l.PD,{className:"h-5 text-black dark:text-white"})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(d.QW,{type:"button",onClick:()=>{e.push("/")},disabled:f,children:"취소"}),(0,a.jsx)(d.jn,{type:"button",onClick:N,disabled:f,children:f?"게시 중...":"게시"})]})]}),(0,a.jsx)("div",{className:"text-left",children:(0,a.jsxs)("p",{className:"text-[18px] font-semibold text-gray-900 dark:text-neutral-200 leading-[140%]",children:["빌런을 제보하거나",(0,a.jsx)("br",{}),"빌런 관련 토론을 시작해보세요."]})})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"px-6 pt-[20px]",children:(0,a.jsx)("textarea",{name:"title",placeholder:"제목을 입력해주세요.",className:"w-full border-none focus:outline-none focus:ring-0 text-black dark:text-white text-[18px] font-medium resize-none bg-transparent",value:s.title,onChange:e=>{v(e),e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},rows:1,style:{minHeight:"24px",height:"auto"},disabled:f})}),(0,a.jsx)("div",{className:"px-6 pt-[4px] pb-[20px]",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{name:"content",placeholder:"빌런 경험을 모두에게 공유해주세요.",className:"w-full h-[200px] md:h-[250px] resize-none border-none focus:outline-none focus:ring-0 text-[16px] text-black dark:text-white bg-transparent",value:s.content,onChange:v,disabled:f})})})}),(0,a.jsxs)("div",{className:"px-6 pb-[20px]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-[16px] font-medium text-gray-700 dark:text-neutral-300",children:["빌런 카테고리",(0,a.jsx)("p",{className:"text-xs text-gray-400 dark:text-neutral-600",children:"관련도가 높은 카테고리에 게시하세요."})]}),(0,a.jsx)("div",{children:g?(0,a.jsx)("div",{className:"text-[15px] text-gray-700 dark:text-neutral-300 px-[11px] py-[7px] pr-9 rounded-[8px] border border-gray-200 dark:border-neutral-700 font-medium min-w-[120px] bg-white dark:bg-neutral-800 relative text-left",children:"로딩 중..."}):(0,a.jsxs)(c,{selectedValue:s.category,onChange:e=>{i(t=>({...t,category:e})),w.category&&k(e=>{let t={...e};return delete t.category,t})},children:[(0,a.jsx)(c.Button,{children:(()=>{if(!s.category)return"선택해주세요";let e=h.find(e=>e.id===s.category);return e?e.name:"선택해주세요"})()}),(0,a.jsx)(c.Menu,{children:h.map(e=>(0,a.jsx)(c.Item,{value:e.id,children:e.name},e.id))})]})})]}),w.category&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:w.category})]})]})]})})}},8039:(e,t,r)=>{Promise.resolve().then(r.bind(r,6544))},8402:(e,t,r)=>{"use strict";r.d(t,{Uz:()=>l,pD:()=>o,ys:()=>d});var a=r(9670),n=r(5317);let o=async e=>{let t=a.j2.currentUser;if(!t)throw Error("로그인이 필요합니다");let r=(0,n.H9)(a.db,"categories",e.categoryId),o=await (0,n.x7)(r);if(!o.exists())throw Error("존재하지 않는 카테고리입니다");let l=o.data().name,d=(0,n.H9)(a.db,"users",t.uid),s=await (0,n.x7)(d),i=s.exists()?s.data():null,c={...e,authorId:t.uid,authorName:(null==i?void 0:i.username)||t.displayName||t.email||"익명",authorPhotoURL:(null==i?void 0:i.photoURL)||t.photoURL||null,categoryName:l,createdAt:(0,n.O5)(),updatedAt:(0,n.O5)(),likes:0,commentCount:0};try{console.log("게시글 생성 시작:",c);let e=await (0,n.gS)((0,n.rJ)(a.db,"posts"),c);return console.log("게시글 생성 성공:",e.id),{id:e.id,...c}}catch(e){throw console.error("게시글 생성 실패:",e),e}},l=async(e,t,r)=>{try{let r=(0,n.H9)(a.db,"posts",e),o=await (0,n.x7)(r);if(!o.exists())throw Error("게시물이 존재하지 않습니다.");(o.data().likedBy||[]).includes(t)?await (0,n.mZ)(r,{likes:(0,n.GV)(-1),likedBy:(0,n.C3)(t),updatedAt:(0,n.O5)()}):await (0,n.mZ)(r,{likes:(0,n.GV)(1),likedBy:(0,n.hq)(t),updatedAt:(0,n.O5)()});let l=await (0,n.x7)(r);return{id:e,...l.data()}}catch(e){throw console.error("좋아요 업데이트 실패:",e),e}},d=async e=>{try{let t=(0,n.P)((0,n.rJ)(a.db,"comments"),(0,n._M)("postId","==",e));for(let e of(await (0,n.GG)(t)).docs){let t=(0,n.H9)(a.db,"comments",e.id),r=(await (0,n.GG)((0,n.rJ)(t,"replies"))).docs.map(e=>(0,n.kd)((0,n.H9)(t,"replies",e.id)));await Promise.all(r),await (0,n.kd)(t)}let r=(0,n.H9)(a.db,"posts",e);return await (0,n.kd)(r),!0}catch(e){throw console.error("포스트 삭제 실패:",e),e}}},9960:(e,t,r)=>{"use strict";r.d(t,{QW:()=>l,bg:()=>o,jn:()=>n});var a=r(5155);r(2115);let n=e=>{let{children:t,...r}=e;return(0,a.jsx)("button",{...r,className:"text-[15px] bg-black dark:bg-white text-white dark:text-gray-900 px-[11px] py-[7px] rounded-[8px] font-medium min-w-[50px]",children:t})},o=e=>{let{children:t,...r}=e;return(0,a.jsx)("button",{...r,className:"text-[15px] text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white px-[11px] py-[7px] rounded-[8px] border border-gray-200 dark:border-neutral-700 hover:border-gray-300 dark:hover:border-neutral-600 font-semibold",children:t})},l=e=>{let{children:t,...r}=e;return(0,a.jsx)("button",{...r,className:"text-[15px] text-gray-700 dark:text-neutral-300 px-[11px] py-[7px] rounded-[8px] hover:bg-gray-200 dark:hover:bg-neutral-700 transition-colors font-medium",children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,146,855,308,441,684,358],()=>t(8039)),_N_E=e.O()}]);